# X) Summary of references.  
## OWASP: OWASP Top 10: A01 Broken Access Control.  
- Broken access control is the most common vulnerability
- Expoliting this vulnerability can be as easy as modifying the URL
## Find Hidden Web Directories - Fuzz URLs with ffuf
- fuff is a tool to scan hidden directories in a web server
- You can find these manually, but fuff does it automatically
##  Access control vulnerabilities and privilege escalation
- Different types of access control are vertical, horizontal and context-based'
- Privilige escalation can be done in a variety of ways, all of them rely on modifying the URL in different ways
## Raportin kirjoittaminen
- The report must be repeatable following the report
- The report must be precise. No omitting information
- The report must be easy to read
- Refer to sources in a proper way.
- DO NOT FABRICATE OR PLAGIARIZE
# A) Breaking in to 010-staff-only: [Hack'n Fix](https://terokarvinen.com/hack-n-fix/)  
I started off by starting up a new virtual machine running debian bookworm 12.  
Next up, I got the latest updates and downloaded micro, wget and unzip  
`sudo apt-get update` 
</br>
`sudo apt-get -y install wget micro unzip`  
After that I downloaded the challenge from https://terokarvinen.com/hack-n-fix/teros-challenges.zip and unzipped it  
`wget https://terokarvinen.com/hack-n-fix/teros-challenges.zip`  
`unzip teros-challenges.zip`
To run the first challenge "staff-only.py", I had to install 2 required extensions, flask and flask sqlalchemy.
`sudo apt-get -y install python3-flask`  
`sudo apt-get -y install python3-flask-sqlalchemy`  
After all the prepwork was done, I started the challenge.  
<img width="553" height="101" alt="image" src="https://github.com/user-attachments/assets/42435e92-6f0d-4af0-ac81-202277c927bb" />  
I navigated to the address given and started to think how I was going to get in.  
<img width="616" height="376" alt="image" src="https://github.com/user-attachments/assets/12d5cffb-89a1-476e-813d-9d87e43bc9ef" />  
At first I opened the web developer console and started looking around. I noticed that the only input value allowed was set to "number" so i changed that to text.  
After that I manipulated the "value" field in various ways, I tried to insert `OR 1=1--` but kept just gettin the "not found" code.  So I had to look a bit of instrucitons on what i was doing wrong.  
I consulted various websites on SQL syntax but the guide from Robin Niinimets finally gave me the answer, i was missin "'" from the front (https://askdatdude.github.io/diary/entries/diary.html?entry=SH24-002&week=)  
Now that the syntax was somewhat correct, I tried again and got this answer.  
<img width="434" height="155" alt="image" src="https://github.com/user-attachments/assets/890bf44e-66b7-4668-8cb5-b1951914f4ab" />  
But this wasn't the answer we were looking for, so back to the drawing board it is.  
After consulting Hack'n Fix guide at the bottom of the page, I treid to insert the LIMIT function to get it to input a different result then just "foo"
I tried all different variations, that caused lots of internal server errors ( I think the cause was that returning more the one result causes an error)  
I studied the syntax, and figured that changing the offset one by one would at some point return the right one. And fortunately I was correct, adding `LIMIT 1,2` finally gave me the flag  
<img width="485" height="151" alt="image" src="https://github.com/user-attachments/assets/a8374657-4e6e-4d33-a036-f425b5fe1832" />  
# B Fixing the vulnerability in the source code  
For this step i didnÂ´t have any clue how to begin, as I don't have much coding experience, and even less SQL experience.  
So, i shamelessly asked chatGPT how to patch this. Unfortunetly chatGPT did not help much in this.  
Aaand this is where i got stuck, i can not continue.  
C) Solving dirfuzt-1 from the article [Find Hidden Web Directories - Fuzz URLs with ffuf.](https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/)  
First i downloaded the dirfuzt-0 target from the website and started it up.  
After that I installed ffuf  
`sudo apt-get install ffuf`  
Now that ffuf is installed and the target is running, I started to fuzz the hidden directories.  
`./ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ`  
<img width="373" height="284" alt="image" src="https://github.com/user-attachments/assets/f222963f-7671-4148-8240-4b702b4b04c1" />  
I got tons of response codes for directories that do not exist, so i filtered out all of the sites that had size 132.  
`./ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ -fs 132`  
And two were found, admin and render/  
<img width="464" height="53" alt="image" src="https://github.com/user-attachments/assets/08bc22e2-af4a-4415-be26-56f0850d558e" />  
Admin seems the most likely, now to the browser to try it out.  
<img width="281" height="182" alt="image" src="https://github.com/user-attachments/assets/952a9994-750a-4f03-be17-93324e8cadba" />

# Timer ran out, I will try to break and fix 020 at a later date










 





# Sources
https://owasp.org/Top10/A01_2021-Broken_Access_Control/  
https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/  
https://portswigger.net/web-security/access-control  
https://terokarvinen.com/2006/raportin-kirjoittaminen-4/  
